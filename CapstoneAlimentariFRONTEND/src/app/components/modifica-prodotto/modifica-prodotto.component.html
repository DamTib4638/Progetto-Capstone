<div class="container">
    <h1 class="text-center">Modifica Prodotto</h1>
    <form #prodotto="ngForm" (ngSubmit)="prodotto.valid && modifica(prodotto)">

        <!-- Nome (obbligatorio max 50) e Marca (obbligatorio max 30) -->
        <div class="row py-3 border border-top-0 border-start-0 border-end-0">
            <div class="col-sm-6">
                <label class="form-label" for="nome">Nome Prodotto *</label>
                <input id="nome" name="nome" type="text" class="form-control text-center" [ngModel]="prod.nome" #nome="ngModel" required minlength="5" maxlength="50">
                <span class="text-info bg-transparent" *ngIf="nome.invalid && (nome.dirty || nome.touched)">
                    Nome Prodotto è OBBLIGATORIO e deve avere minimo 5 e massimo 50 caratteri
                </span>
            </div>
            <div class="col-sm-6">
                <label class="form-label" for="marca">Marca Prodotto *</label>
                <input id="marca" name="marca" type="text" class="form-control text-center" [ngModel]="prod.marca" #marca="ngModel" required minlength="5" maxlength="30">
                <span class="text-info bg-transparent" *ngIf="marca.invalid && (marca.dirty || marca.touched)">
                    Marca Prodotto è OBBLIGATORIA e deve avere minimo 5 e massimo 30 caratteri
                </span>
            </div>
        </div>

        <!-- Descrizione e Ingredienti (obbligatorio, almeno un carattere) -->
        <div class="row py-3 border border-top-0 border-start-0 border-end-0">
            <div class="col-sm-6">
                <label class="form-label" for="descrizione">Descrizione Prodotto</label>
                <textarea name="descrizione" id="descrizione" rows="2" class="form-control" [ngModel]="prod.descrizione" #descrizione="ngModel"></textarea>
            </div>
            <div class="col-sm-6">
                <label class="form-label" for="ingredienti">Ingredienti Prodotto *</label>
                <textarea name="ingredienti" id="ingredienti" rows="2" class="form-control" [ngModel]="prod.ingredienti" #ingredienti="ngModel" required minlength="1"></textarea>
                <span class="text-info bg-transparent" *ngIf="ingredienti.invalid && (ingredienti.dirty || ingredienti.touched)">
                    Ingredienti Prodotto è OBBLIGATORIO e deve avere almeno 1 carattere
                </span>
            </div>
        </div>

        <!-- Tipo Prodotto (enum), Categoria Prodotto (enum) e Data Scadenza (obbligatori) -->
        <div class="row py-3 border border-top-0 border-start-0 border-end-0">
            <div class="col-sm-4">
                <label class="form-label" for="tipoProdotto">Tipologia Prodotto *</label>
                <select name="tipoProdotto" class="form-select" [ngModel]="prod.tipoProdotto" #tipoProdotto="ngModel" required>
                    <option value=""></option>
                    <option value="FRUTTA">FRUTTA</option>
                    <option value="VERDURA">VERDURA</option>
                    <option value="CARNE">CARNE</option>
                    <option value="PESCE">PESCE</option>
                    <option value="PANE">PANE</option>
                    <option value="PIZZA">PIZZA</option>
                    <option value="PASTA">PASTA</option>
                    <option value="RISO">RISO</option>
                    <option value="CEREALI">CEREALI</option>
                    <option value="FARINA">FARINA</option>
                    <option value="LATTE">LATTE</option>
                    <option value="FORMAGGIO">FORMAGGIO</option>
                    <option value="UOVA">UOVA</option>
                    <option value="BURRO">BURRO</option>
                    <option value="SALSA">SALSA</option>
                    <option value="SNACK_DOLCE">SNACK_DOLCE</option>
                    <option value="SNACK_SALATO">SNACK_SALATO</option>
                    <option value="ACQUA">ACQUA</option>
                    <option value="BEVANDA_ALCOLICA">BEVANDA_ALCOLICA</option>
                    <option value="BEVANDA_ANALCOLICA">BEVANDA_ANALCOLICA</option>
                    <option value="CIBO_ANIMALI">CIBO_ANIMALI</option>
                    <option value="ACCESSORI_ANIMALI">ACCESSORI_ANIMALI</option>
                    <option value="PULIZIA_ANIMALI">PULIZIA_ANIMALI</option>
                    <option value="PULIZIA_CASA">PULIZIA_CASA</option>
                    <option value="CARTA">CARTA</option>
                    <option value="SHAMPOO">SHAMPOO</option>
                    <option value="BAGNOSCHIUMA">BAGNOSCHIUMA</option>
                    <option value="DENTIFRICIO">DENTIFRICIO</option>
                    <option value="INTIMO_ADULTO">INTIMO_ADULTO</option>
                    <option value="INTIMO_BIMBO">INTIMO_BIMBO</option>
                    <option value="CIBO_BIMBO">CIBO_BIMBO</option>
                    <option value="ACCESSORI_BIMBO">ACCESSORI_BIMBO</option>
                    <option value="TEMPO_LIBERO">TEMPO_LIBERO</option>
                </select>
                <span class="text-info bg-transparent" *ngIf="tipoProdotto.invalid && (tipoProdotto.dirty || tipoProdotto.touched)">
                    Tipologia Prodotto è OBBLIGATORIA
                </span>
            </div>
            <div class="col-sm-4">
                <label class="form-label" for="categoriaProdotto">Categoria Prodotto *</label>
                <select name="categoriaProdotto" class="form-select" [ngModel]="prod.categoriaProdotto" #categoriaProdotto="ngModel" required>
                    <option value=""></option>
                    <option value="FRUTTA_VERDURA">FRUTTA_VERDURA</option>
                    <option value="LATTE_FORMAGGIO">LATTE_FORMAGGIO</option>
                    <option value="CARNE_PESCE">CARNE_PESCE</option>
                    <option value="FRESCO">FRESCO</option>
                    <option value="SURGELATO">SURGELATO</option>
                    <option value="IN_SCATOLA">IN_SCATOLA</option>
                    <option value="FORNO_SNACK">FORNO_SNACK</option>
                    <option value="DOLCI">DOLCI</option>
                    <option value="COLAZIONE">COLAZIONE</option>
                    <option value="BEVANDA">BEVANDA</option>
                    <option value="CURA_PERSONALE">CURA_PERSONALE</option>
                    <option value="CURA_CASA">CURA_CASA</option>
                    <option value="ANIMALI">ANIMALI</option>
                    <option value="HOBBY">HOBBY</option>
                    <option value="SPECIAL">SPECIAL</option>
                </select>
                <span class="text-info bg-transparent" *ngIf="categoriaProdotto.invalid && (categoriaProdotto.dirty || categoriaProdotto.touched)">
                    Categoria Prodotto è OBBLIGATORIA
                </span>
            </div>
            <div class="col-sm-4">
                <label class="form-label" for="dataScadenza">Data Scadenza Prodotto *</label>
                <input id="dataScadenza" name="dataScadenza" type="date" class="form-control" [ngModel]="prod.dataScadenza" #dataScadenza="ngModel" required>
                <span class="text-info bg-transparent" *ngIf="dataScadenza.invalid && (dataScadenza.dirty || dataScadenza.touched)">
                    Data Scadenza Prodotto è OBBLIGATORIA
                </span>
            </div>
        </div>

        <!-- Quantità O Peso (uno dei due fai scelta e > 0), Prezzo Acquisto (obbligatorio > 0), Prezzo Vendita (obbligatorio > 0) -->
        <div class="row py-3 border border-top-0 border-start-0 border-end-0" hidden>
            <div class="col-4" hidden>
                <label class="form-label" for="sceltaQtaPeso">SCEGLI TRA QUANTITà E PESO *</label>
                <select name="sceltaQtaPeso" class="form-select" [(ngModel)]="sceltaQtaPeso" disabled>
                    <option value="0"></option>
                    <option value="1">Prodotto venduto al pezzo</option>
                    <option value="2">Prodotto venduto al chilo</option>
                </select>
                <span class="text-info bg-transparent" *ngIf="!(sceltaQtaPeso == 1) && !(sceltaQtaPeso == 2)">
                    Scegli una delle due opzioni
                </span>
            </div>
        </div>

        <div class="row py-3 border border-top-0 border-start-0 border-end-0">
            <!-- Prezzo Acq (obbligatorio e > 0) -->
            <div class="col-sm-4">
                <label class="form-label" for="prezzoAcquistoUnitario">Prezzo Acquisto Unitario Prodotto *</label>
                <input type="number" name="prezzoAcquistoUnitario" id="prezzoAcquistoUnitario" class="form-control text-center" [ngModel]="prod.prezzoAcquistoUnitario" #prezzoAcquistoUnitario="ngModel" required min="0.1">
                <span class="text-info bg-transparent" *ngIf="prezzoAcquistoUnitario.invalid && (prezzoAcquistoUnitario.dirty || prezzoAcquistoUnitario.touched)">
                    Prezzo Acquisto Unitario Prodotto è OBBLIGATORIO e deve avere un valore maggiore di 0
                </span>
            </div>
            <!-- Prezzo Ven (obbligatorio e > 0) -->
            <div class="col-sm-4">
                <label class="form-label" for="prezzoVenditaUnitario">Prezzo Vendita Unitario Prodotto *</label>
                <input type="number" name="prezzoVenditaUnitario" id="prezzoVenditaUnitario" class="form-control text-center" [ngModel]="prod.prezzoVenditaUnitario" #prezzoVenditaUnitario="ngModel" required min="0.1">
                <span class="text-info bg-transparent" *ngIf="prezzoVenditaUnitario.invalid && (prezzoVenditaUnitario.dirty || prezzoVenditaUnitario.touched)">
                    Prezzo Vendita Unitario Prodotto è OBBLIGATORIO e deve avere un valore maggiore di 0
                </span>
            </div>
            <!-- inizio ngIf -->
            <div class="col-sm-4" *ngIf="sceltaQtaPeso == 1">
                <label class="form-label" for="qtaDisponibile">Quantità Disponibile Prodotto *</label>
                <input type="number" name="qtaDisponibile" id="qtaDisponibile" class="form-control text-center" [ngModel]="prod.qtaDisponibile" #qtaDisponibile="ngModel" required min="0">
                <span class="text-info bg-transparent" *ngIf="sceltaQtaPeso == 1 && qtaDisponibile.invalid && (qtaDisponibile.dirty || qtaDisponibile.touched)">
                    La quantità non può essere negativa
                </span>
            </div>
            <div class="col-sm-4" *ngIf="sceltaQtaPeso == 2">
                <label class="form-label" for="pesoDisponibile">Peso Disponibile Prodotto *</label>
                <input type="number" name="pesoDisponibile" id="pesoDisponibile" class="form-control text-center" [ngModel]="prod.pesoDisponibile" #pesoDisponibile="ngModel" required min="0">
                <span class="text-info bg-transparent" *ngIf="sceltaQtaPeso == 2 && pesoDisponibile.invalid && (pesoDisponibile.dirty || pesoDisponibile.touched)">
                    Il peso non può essere negativo
                </span>
            </div>
            <!-- fine ngIf -->
        </div>

        <!-- Percentuale Offerta, Scaffale (Get Tutti) (obbligatorio) -->
        <div class="row py-3 border border-top-0 border-start-0 border-end-0">
            <div class="col-sm-6">
                <label class="form-label" for="percentualeOfferta">Percentuale Offerta Prodotto</label>
                <input type="number" name="percentualeOfferta" id="percentualeOfferta" class="form-control text-center" [ngModel]="prod.percentualeOfferta" #percentualeOfferta="ngModel" min="1" max="90">
                <span class="text-info bg-transparent" *ngIf="percentualeOfferta.invalid && (percentualeOfferta.dirty || percentualeOfferta.touched)">
                    Il valore della percentuale di offerta, se inserito, deve avere un valore compreso tra 1 e 90
                </span>
            </div>
            <div class="col-sm-6">
                <label class="form-label" for="idScaffale">Scaffale *</label>
                <select class="form-select" name="idScaffale" [ngModel]="scaf.idScaffale" #idScaffale="ngModel" required>
                    <option value=""></option>
                    <option *ngFor="let scaffale of listaScaffali" value="{{scaffale.idScaffale}}">{{scaffale.idScaffale}} - {{scaffale.nome}}</option>
                </select>
                <span class="text-info bg-transparent" *ngIf="idScaffale.invalid && (idScaffale.dirty || idScaffale.touched)">
                    Lo Scaffale a cui associare il Prodotto è OBBLIGATORIO
                </span>
            </div>
        </div>

        <div class="d-flex justify-content-center mt-2">
            <button class="btn btn-info me-3 text-white" (click)="tornaIndietro()">Back</button>
            <button class="btn btn-info text-white" type="submit" [disabled]="prodotto.invalid">Modifica Prodotto</button>
        </div>
    </form>
</div>
